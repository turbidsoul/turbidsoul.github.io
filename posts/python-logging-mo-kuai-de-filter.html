<!doctype html>
<html lang="cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>python logging 模块的 filterTurbidsoul's 小黑屋</title>

    <link rel="stylesheet" href="http://blog.turbidsoul.me/theme/css/main.css">
    <link rel="stylesheet" href="http://blog.turbidsoul.me/theme/css/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <div><img src="http://blog.turbidsoul.me/images/avatar.jpg" class="grv-img"/></div>
        <div class="title"><a href="http://blog.turbidsoul.me/">Turbidsoul's 小黑屋 </a></div>
        <div class="sub-title"></div>

<p>
  <div class="view"><a href="http://blog.turbidsoul.me/archives.html">Archives</a></div>
</p>

<!-- Social links -->
<div class="social">
<h4>Follow Me</h4>
<ul>
    <li><a href="https://plus.google.com/+TurbidsoulChen">Google+</a></li>
    <li><a href="https://github.com/turbidsoul">Github</a></li>
    <li><a href="https://twitter.com/Turbidsoul">Twitter</a></li>
    <li><a href="https://facebook.com/turbidsoul">Facebook</a></li>
    <li><a href="http://weibo.com/turbidsoul">微博</a></li>
    <li><a href="http://instagram.com/turbidsoul">Instagram</a></li>
</ul>
</div>

      </header>
      <section>
<section id="content" class="body">
  <article>
      <div class="article-title">
        python logging 模块的 filter
      </div>

    <div class="entry-content">
<p>
<small>
<abbr class="published" title="2013-11-22">
  2013年 十一月 22日 周五
</abbr> | 
  tags: 
    <a href="http://blog.turbidsoul.me/tag/python.html">python</a>, 
    <a href="http://blog.turbidsoul.me/tag/logging.html">logging</a>, 
    <a href="http://blog.turbidsoul.me/tag/filter.html">filter</a>, 
    <a href="http://blog.turbidsoul.me/tag/code.html">code</a>, 
 -- (<a href="http://blog.turbidsoul.me/posts/python-logging-mo-kuai-de-filter.html" rel="bookmark">permalink</a>)
</small>
</p>      <p>前两天同事问我，如果针对不同的IP记录日志，并把更具IP记录到不同的日志文件中，在网上搜了一下这个问题，有很多人都在问，我查了一下python的logging的api，发现有个filter的，这个filter可以根据日志的信息来决定这条日志是否记录到日志文件中，下面来说说如果实现这个功能。</p>
<p>通常我们配置日志都是如下代码：</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="n">hdlr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s">&#39;test.log&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdlr</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(asctime)s</span><span class="s">  </span><span class="si">%(levelname)s</span><span class="s">  Line#</span><span class="si">%(lineno)d</span><span class="s"> - </span><span class="si">%(msecs)d</span><span class="s"> - </span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">hdlr</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;test 111111&#39;</span><span class="p">)</span>
</pre></div>


<p>这是我们通常用来配置记录日志到文件的代码，但是如果我们要把日志记根据条件记录到不同的日志文件中就需要用到 <strong><a href="http://docs.python.org/2/library/logging.html?highlight=filter#logging.Filter">logging.Filter</a></strong></p>
<p>我们可以对上面的代码做一点点的修改，创建一个过滤器，这个过滤器是根据IP进行过滤的，只有IP是创建过滤器时指定的IP才能被记录下来，下面来看看我创建的过滤器:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="k">class</span> <span class="nc">MyFilter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Filter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></div>


<p>我的过滤器创建好之后就是要把这个过滤器加入到我们的日志处理句柄上，这里我创建了两个Handler，用来存储不同IP的日志，每个Handler添加不同的过滤器，如下:</p>
<div class="highlight"><pre><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(asctime)s</span><span class="s">  </span><span class="si">%(levelname)s</span><span class="s"> - </span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">hdlr1</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s">&#39;127.0.0.1.log&#39;</span><span class="p">)</span>
<span class="n">hdlr1</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">MyFilter</span><span class="p">(</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">))</span>
<span class="n">hdlr1</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
<span class="n">hdlr2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s">&#39;192.168.0.2.log&#39;</span><span class="p">)</span>
<span class="n">hdlr2</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">MyFilter</span><span class="p">(</span><span class="s">&#39;192.168.0.2&#39;</span><span class="p">))</span>
<span class="n">hdlr2</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdlr1</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdlr2</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>


<p>如上代码，对127.0.0.1开头的日志存到127.0.0.1.log文件中，同样192.168.0.2开头的日志存到192.168.0.2.log文件中</p>
<div class="highlight"><pre><span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">13</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET / HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">612</span> <span class="s">&quot;-&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">14</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /favicon.ico HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">168</span> <span class="s">&quot;-&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">14</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /favicon.ico HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">168</span> <span class="s">&quot;-&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">14</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /favicon.ico HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">168</span> <span class="s">&quot;-&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">20</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror.html HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">6783</span> <span class="s">&quot;-&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/lib/codemirror.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">5705</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/rubyblue.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1294</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/ambiance.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">26029</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/eclipse.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1050</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/ambiance-mobile.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">103</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/erlang-dark.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1223</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/elegant.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">593</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/blackboard.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1237</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/midnight.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1709</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/monokai.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1162</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/lesser-dark.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1991</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/cobalt.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1048</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
<span class="mf">127.0.0.1</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /codemirror/theme/night.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1129</span> <span class="s">&quot;http://localhost/codemirror.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20100101 Firefox/21.0&quot;</span>
  <span class="p">.</span>
  <span class="p">.</span>
  <span class="p">.</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">20</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3348</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">40</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET / HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/pages.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">40</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">40</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">40</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET / HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">4041</span> <span class="s">&quot;http://test.turbidsoul.me/pages.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">47729</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1657</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3348</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">32</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET / HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3768</span> <span class="s">&quot;http://test.turbidsoul.me/pages.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">32</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">47729</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">32</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1657</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">32</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3348</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">24</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET / HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3969</span> <span class="s">&quot;http://test.turbidsoul.me/pages.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">24</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">47729</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">24</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">3348</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">24</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">1657</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">26</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /java/2013/05/16/spring-configuration-file-and-annotation-load-question HTTP/1.1&quot;</span> <span class="mi">301</span> <span class="mi">184</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">26</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /java/2013/05/16/spring-configuration-file-and-annotation-load-question/ HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">14041</span> <span class="s">&quot;http://test.turbidsoul.me/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">26</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/java/2013/05/16/spring-configuration-file-and-annotation-load-question/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">26</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/java/2013/05/16/spring-configuration-file-and-annotation-load-question/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">26</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/java/2013/05/16/spring-configuration-file-and-annotation-load-question/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">11</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /tags.html HTTP/1.1&quot;</span> <span class="mi">200</span> <span class="mi">9499</span> <span class="s">&quot;http://test.turbidsoul.me/java/2013/05/16/spring-configuration-file-and-annotation-load-question/&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">11</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/1.4.0/bootstrap.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/tags.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">11</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/style.css?body=1 HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/tags.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
<span class="mf">192.168.0.2</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="n">May</span><span class="o">/</span><span class="mi">2013</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">11</span> <span class="o">+</span><span class="mi">0800</span><span class="p">]</span> <span class="s">&quot;GET /assets/themes/twitter/css/pygments.css HTTP/1.1&quot;</span> <span class="mi">304</span> <span class="mi">0</span> <span class="s">&quot;http://test.turbidsoul.me/tags.html&quot;</span> <span class="s">&quot;Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0&quot;</span>
  <span class="p">.</span>
  <span class="p">.</span>
  <span class="p">.</span>
</pre></div>


<p>这是我的nginx的access.log中的一段日志，我用这段日志来做测试，最终得到的结果和我最初预设的是一样的，我在这里就不再贴出测试的结果，有兴趣的朋友可以自己测试一下。</p>
    </div><!-- /.entry-content -->
  </article>
</section>
      </section>
      <footer>
        <p><small>&copy; Turbidsoul's 小黑屋 &mdash; Theme based on Sundown by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <!-- Scale fix -->
    <script>
      var metas = document.getElementsByTagName('meta');
      var i;
      
      if (navigator.userAgent.match(/iPhone/i)) {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=1.0, maximum-scale=1.0";
          }
        }
      
        document.addEventListener("gesturestart", gestureStart, false);
      }

      function gestureStart() {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=0.25, maximum-scale=1.6";
          }
        }
      }
    </script>
  </body>
</html>